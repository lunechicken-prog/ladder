<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ„ è–èª•äº¤æ›ç¦®ç‰©ï¼é¬¼è…³åœ– ğŸ</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f4f4f4;
    text-align: center;
}

h1 {
    margin: 10px 0;
    color: #c62828;
    font-size: 20px;
}

#top, #bottom {
    display: grid;
    grid-template-columns: repeat(17, 1fr);
    max-width: 100vw;
    margin: 6px auto;
    font-weight: bold;
    font-size: 14px;
}

#top div {
    cursor: pointer;
}

#ladder-wrapper {
    position: relative;
    width: 100%;
    overflow-x: auto;
}

#ladder {
    position: relative;
    width: 100%;
    max-width: 680px;
    height: 900px;
    margin: 0 auto;
    background: white;
}

.vline {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 2px;
    background: #333;
}

.hline {
    position: absolute;
    height: 4px;
    background: #333;
}

.player {
    position: absolute;
    width: 16px;
    height: 16px;
    background: #ffeb3b;
    border-radius: 50%;
    box-shadow: 0 0 8px rgba(0,0,0,0.4);
    transform: translate(-50%, -50%);
    transition: left 0.25s linear, top 0.25s linear;
    z-index: 10;
}

#result {
    font-size: 20px;
    margin: 12px 0;
}
</style>
</head>

<body>

<h1>ğŸ„ è–èª•äº¤æ›ç¦®ç‰©ï¼é¬¼è…³åœ– ğŸ</h1>

<div id="top"></div>

<div id="ladder-wrapper">
    <div id="ladder"></div>
</div>

<div id="bottom"></div>

<div id="result"></div>

<script>
const cols = 17;
const rows = 30;               // å¤ é•·
const icons = ["ğŸ","ğŸ„","ğŸ…","â­","ğŸ°","ğŸº","ğŸ’","ğŸ‘‘","ğŸ§","ğŸ“±","ğŸ§¸","ğŸ·","ğŸ®","â˜•","ğŸ‚","ğŸ•¯ï¸","ğŸ‰"];

const ladder = document.getElementById("ladder");
const topDiv = document.getElementById("top");
const bottomDiv = document.getElementById("bottom");
const result = document.getElementById("result");

let hLines = [];
let colCenters = [];

// å»ºç«‹ä¸Šæ–¹æ•¸å­—
for (let i = 1; i <= cols; i++) {
    const d = document.createElement("div");
    d.innerText = i;
    d.onclick = () => start(i - 1);
    topDiv.appendChild(d);
}

// å»ºç«‹ä¸‹æ–¹åœ–æ¡ˆ
icons.forEach(icon => {
    const d = document.createElement("div");
    d.innerText = icon;
    bottomDiv.appendChild(d);
});

// è¨ˆç®—æ¬„ä½ä¸­å¿ƒï¼ˆåŒä¸€ä¾†æºï¼‰
function calculateColumns() {
    const width = ladder.clientWidth;
    colCenters = [];
    for (let i = 0; i < cols; i++) {
        colCenters.push(width * (i + 0.5) / cols);
    }
}

// ç•«ç›´ç·š
function drawVLines() {
    ladder.innerHTML = "";
    calculateColumns();

    colCenters.forEach(x => {
        const v = document.createElement("div");
        v.className = "vline";
        v.style.left = x + "px";
        ladder.appendChild(v);
    });
}

// ç”¢ç”Ÿæ©«ç·šï¼ˆä¸é€£çºŒï¼‰
function generateHLines() {
    hLines = [];
    for (let r = 0; r < rows; r++) {
        hLines[r] = [];
        for (let c = 0; c < cols - 1; c++) {
            if (Math.random() < 0.35 && !hLines[r][c - 1]) {
                hLines[r][c] = true;
                const h = document.createElement("div");
                h.className = "hline";
                h.style.left = colCenters[c] + "px";
                h.style.top = (r * 28 + 20) + "px";
                h.style.width = (colCenters[c + 1] - colCenters[c]) + "px";
                ladder.appendChild(h);
            }
        }
    }
}

function setup() {
    drawVLines();
    generateHLines();
}

window.addEventListener("resize", setup);
setup();

// å¹³é †å‹•ç•«ï¼ˆé€ç¯€é»ï¼‰
async function start(startCol) {
    ladder.querySelectorAll(".player").forEach(p => p.remove());
    result.innerText = "";

    let c = startCol;
    let r = 0;

    const p = document.createElement("div");
    p.className = "player";
    ladder.appendChild(p);

    p.style.left = colCenters[c] + "px";
    p.style.top = "0px";

    for (; r < rows; r++) {
        await moveTo(p, colCenters[c], r * 28 + 20);

        if (c > 0 && hLines[r][c - 1]) {
            c--;
            await moveTo(p, colCenters[c], r * 28 + 20);
        } else if (hLines[r][c]) {
            c++;
            await moveTo(p, colCenters[c], r * 28 + 20);
        }
    }

    result.innerText = "ğŸ‰ çµæœï¼šç¬¬ " + (startCol + 1) + " è™Ÿ â†’ " + icons[c] + " ç¦®ç‰©ï¼";
}

function moveTo(el, x, y) {
    return new Promise(resolve => {
        el.style.left = x + "px";
        el.style.top = y + "px";
        setTimeout(resolve, 260);
    });
}
</script>

</body>
</html>
